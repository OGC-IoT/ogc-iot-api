<!DOCTYPE html>
<html>
	<head>
		<title>OGC SensorThings API</title>
		<link rel="shortcut icon" href="http://sensorweb.geomatics.ucalgary.ca/gsw/sites/default/files/zeropoint_favicon_1.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Bootstrap -->
		<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
		<link href="css/bootswatch.css" rel="stylesheet">
		<link href="css/bootstrap-responsive.css" rel="stylesheet">
	</head>
	<body class="preview" id="top" data-spy="scroll" data-target=".subnav" data-offset="80">
		<!-- Navbar -->
		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html">OGC SensorThings API</a>
					<div class="nav-collapse collapse" id="main-menu">
						<ul class="nav pull-right" id="main-menu-right">
							<li><a href="index.html">Home</a></li>
							<li><a id="swatch-link" href="background.html">FAQ</a></li>
							<li><a id="swatch-link" href="quickstart.html">Quickstart</a></li>
							<li><a id="swatch-link" href="datamodel.html">Data Model</a></li>
							<li><a id="swatch-link" href="api.html">API Reference</a></li>
							<!--<li><a id="swatch-link" href="libraries.html">Libraries</a></li>-->
							<li><a id="swatch-link" href="ecosystem.html">Ecosystem</a></li>
							<li class="dropdown" id="preview-menu">
								<a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a target="_blank" href="https://lists.opengeospatial.org/mailman/listinfo/swe-iot.swg">OGC Maillist</a></li>
									<li><a target="_blank" href="https://portal.opengeospatial.org/wiki/SWEIoTSwg">OGC Twiki</a></li>
									<!--<li><a id="swatch-link" href="#">Forum</a></li>-->
									<li><a href="mailto:geosensorweblab@gmail.com">Email Us</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		
		<div class="container">
			<h1>API Reference</h1>
			<hr>
			<div class="subnav">
				<ul class="nav nav-pills">
					<li><a href="#Introduction">Introduction</a></li>
					<li class="dropdown" id="preview-menu">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">URI Components<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#URIComponents">Introduction</a></li>
							<li><a href="#ResourcePath">Resource Path</a></li>
							<li><a href="#QueryOptions">Query Options</a></li>
							<li><a style="margin-left: 10px;" href="#orderby_query">$orderby</a></li>
							<li><a style="margin-left: 10px;" href="#top_query">$top</a></li>
							<li><a style="margin-left: 10px;" href="#skip_query">$skip</a></li>
							<li><a style="margin-left: 10px;" href="#filter_query">$filter</a></li>
							<li><a style="margin-left: 20px;" href="#filterOperations">Built-in Filter Operations</a></li>
							<li><a style="margin-left: 20px;" href="#queryFunctions">Built-in Query Functions</a></li>
							<li><a style="margin-left: 10px;" href="#expand_query">$expand</a></li>
							<li><a style="margin-left: 10px;" href="#select_query">$select</a></li>
							<li><a style="margin-left: 10px;" href="#count_query">$count</a></li>
						</ul>
					</li>
					<li class="dropdown" id="preview-menu">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">$capabilities<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#capabilities">Introduction</a></li>
							<li><a href="#request_capabilities">Request</a></li>
							<li><a href="#response_capabilities">Response</a></li>
						</ul>
					</li>
					<li class="dropdown" id="preview-menu">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">Sensing Profile<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#DatastreamProfile">Introduction</a></li>
							<li><a href="#Resources_DatastreamProfile">Resources</a></li>
							<li><a href="#Create_DatastreamProfile">Create a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Create_DatastreamProfile">Request</a></li>
							<li><a style="margin-left: 20px;" href="#Link_to_existing_entities_when_creating_an_entity">Link to Existing Entities when Creating an Entity</a></li>
							<li><a style="margin-left: 20px;" href="#Create_related_entities_when_creating_an_entity">Create Related Entities when Creating an Entity</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Create_DatastreamProfile">Response</a></li>
							<li><a href="#Read_DatastreamProfile">Read a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Read_DatastreamProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Read_DatastreamProfile">Response</a></li>
							<li><a href="#Update_DatastreamProfile">Update a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Update_DatastreamProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Update_DatastreamProfile">Response</a></li>
							<li><a href="#Delete_DatastreamProfile">Delete a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Delete_DatastreamProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Delete_DatastreamProfile">Response</a></li>
						</ul>
					</li>
					<li class="dropdown" id="preview-menu">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">Tasking Profile<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#TaskingCapabilityProfile">Introduction</a></li>
							<li><a href="#Resources_TaskingCapabilityProfile">Resources</a></li>
							<li><a href="#Create_TaskingCapabilityProfile">Create a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Create_TaskingCapabilityProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Create_TaskingCapabilityProfile">Response</a></li>
							<li><a href="#Read_TaskingCapabilityProfile">Read a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Read_TaskingCapabilityProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Read_TaskingCapabilityProfile">Response</a></li>
							<li><a href="#Update_TaskingCapabilityProfile">Update a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Update_TaskingCapabilityProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Update_TaskingCapabilityProfile">Response</a></li>
							<li><a href="#Delete_TaskingCapabilityProfile">Delete a Resource</a></li>
							<li><a style="margin-left: 10px;" href="#Request_Delete_TaskingCapabilityProfile">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Response_Delete_TaskingCapabilityProfile">Response</a></li>
						</ul>
					</li>
					<li class="dropdown" id="preview-menu">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">Batch Processing<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#BatchProcessing">Introduction</a></li>
							<li><a href="#Request_BatchProcessing">Request</a></li>
							<li><a style="margin-left: 10px;" href="#Headers_Request_BatchProcessing">Headers</a></li>
							<li><a style="margin-left: 10px;" href="#Body_Request_BatchProcessing">Message Body</a></li>
							<li><a href="#Process_BatchProcessing">Process a Batch Request</a></li>
							<li><a href="#Response_BatchProcessing">Response</a></li>
							<li><a style="margin-left: 10px;" href="#Headers_Response_BatchProcessing">Headers</a></li>
							<li><a style="margin-left: 10px;" href="#Body_Response_BatchProcessing">Message Body</a></li>
						</ul>
					</li>
					<li><a href="#StatusCode">StatusCode</a></li>
				</ul>
			</div>
			<hr>
			
			<div class="row">
				<section id="Introduction">
					<h2>1. Introduction</h2>
					<p class="lead">The SensorThings API defines a RESTful web service interface, in which users can perform CREATE, READ, UPDATE, and DELETE (CRUD) actions to any uniquely-identifiable resources in the service.</p>
					<p class="lead">The OGC SensorThings service interface is different from the other OGC web services, in that it is based on RESTful web service style and JSON encoding. The OGC SensorThings API is inspired by the OASIS Open Data Protocol (OData), which defines a general-purpose RESTful service interface. The SensorThings service interface is very similar to the OData but specifically designed for the IoT.</p>
					<p class="lead">Besides the OData, the SensorThings service interface also leverages the existing and widely implemented OGC standards. For example, the capabilities part of the OGC SensorThings service interface adapts some elements from the GetCapabilities response defined in <a href="http://www.opengeospatial.org/standards/common">the OWS Common</a> by converting the XML encoding into the JSON encoding.</p>
					<p class="lead">The OGC SensorThings API consists of two major profiles: the <i><a href="#DatastreamProfile">Sensing Profile</a></i> and the <i><a href="#TaskingCapabilityProfile">Tasking Profile</a></i>. The <a href="#DatastreamProfile">Sensing Profile</a> is designed based on <a href="http://www.opengeospatial.org/standards/sos">the OGC Sensor Observation Service (SOS) specification</a> in which defines an interoperable framework to manage and access sensors and observations. The <a href="#TaskingCapabilityProfile">Tasking Profile</a> is based on <a href="http://www.opengeospatial.org/standards/sps">the OGC Sensor Planning Service (SPS) specification</a>, in which defines an interoperable way to submit tasks to control sensors and actuators.</p>
					<p class="lead">In the following subsections, we first describe the <a href="#URIComponents">URI Components</a> for addressing resources and possible query options. Then we define the protocol of retrieving the <a href="#capabilities">capabilities</a> document. Finally, we explain the CRUD requests and responses in the <a href="#SensingProfile">Sensing Profile</a> and <a href="#TaskingProfile">Tasking Profile</a>.</p>
					<p class="lead">In this API reference page, we mainly focus on describing the behaviour of the OGC SensorThings API without presenting detailed examples. Instead, the complete data model and JSON examples of resources can be found in the <a id="swatch-link" href="datamodel.html">Data Model</a> page.</p>
				</section>
				<section id="URIComponents">
					<h2>2. URI Components</h2>
					<p class="lead">Similar to the OASIS OData, the OGC SensorThings API groups the same types of entities into collections. Each entity has a unique identifier and one to many properties. Also, in the case of an entity holding a relationship with entities in another collection, this entity has a navigation property (<em>i.e.</em>, a link) linking to other entities. The complete data model and JSON examples of resources can be found in the <a id="swatch-link" href="datamodel.html">Data Model</a> page.</p>
					<p class="lead">Therefore, in order to perform <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> actions on the resources, the first step is to address to the target resource(s) through URI. There are three major URI components used in this API: the <i>service root URI</i>, the <i><a href="#ResourcePath">Resource Path</a></i>, and the <i><a href="#QueryOptions">Query Options</a></i>. The service root URI is the location of the SensorThings service. By attaching the resource path after the service root URI, users can address to different kinds of resources such as <i>a collection</i>, <i>an entity</i>, <i>a property</i>, or <i>a navigation property</i>. Finally, when users perform the READ (<em>i.e.</em>, HTTP GET) action on resource(s), users can apply query options to further process the addressed resources, such as sorting by properties and filtering with criteria.</p>
					<section id="ResourcePath">
						<h3>2.1 Resource Path</h3>
						<p class="lead">The resource path comes right after the service root URI and can be used to address to different resources. The following lists the general usages of the resource path.</p>
						<p><em>Usage 1: No resource path</em></p>
						<p class="tab">If a user request does not include any resource path, the SensorThings service returns a list of collection names as the service document.</p>
						<p class="tab"><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI</var></p>
						<p class="tab"><strong>Response: </strong>A list of collection names.</p>
						<p class="tab"><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/">http://demo.student.geocens.ca:8080/SWIOT_V1.0/</a></p>
						<p><em>Usage 2: Address to an entity collection</em></p>
						<p class="tab">To address to an entity collection, users can simply put the collection name after the service root URI. The service returns a list of all the entities in the specified collection.</p>
						<p class="tab"><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/COLLECTION_NAME</var></p>
						<p class="tab"><strong>Response: </strong>A list of all entities (with all the properties) in the specified collection (if no service-driven pagination imposed).</p>
						<p class="tab"><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Things">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Things</a></p>
						<p><em>Usage 3: Address to an entity in a collection</em></p>
						<p class="tab">Users can address to a specific entity in a collection by place the unique identifier of the entity between brace symbol "()" and put after the collection name. The service then returns the entity with all its properties.</p>
						<p class="tab"><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/COLLECTION_NAME(KEY_OF_ENTITY)</var></p>
						<p class="tab"><strong>Response: </strong>An entity (with all its properties) that holds the specified key in the collection.</p>
						<p class="tab"><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Things(1)">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Things(1)</a></p>
						<p><em>Usage 4: Address to a property of an entity</em></p>
						<p class="tab">Users can address to a property of an entity by specifying the property name after the URI addressing to the entity. The service then returns the value of the specified property.</p>
						<p class="tab"><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/COLLECTION_NAME(KEY_OF_ENTITY)/PROPERTY_NAME</var></p>
						<p class="tab"><strong>Response: </strong>The specified property of an entity that holds the key in the collection.</p>
						<p class="tab"><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Observations(1)/Time">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Observations(1)/Time</a></p>
						<p><em>Usage 5: Address to a navigation property (link)</em></p>
						<p class="tab">As the entities in different collections may hold some relationships, users can request the linked entities by addressing to a navigation property of an entity. The service then returns one or many entities that hold a certain relationship with the specified entity.</p>
						<p class="tab"><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/COLLECTION_NAME(KEY_OF_ENTITY)/LINK_NAME</var></p>
						<p class="tab"><strong>Response: </strong>One or many entities that holds a certain relationship with the specified entity.</p>
						<p class="tab"><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations</a> returns all the observations in the datastream.</p>
						<p><em>Usage 6: Nested resource path</em></p>
						<p class="tab">As users can use navigation properties to link from one collection to another, users can further extend the resource path with unique identifiers, properties, or links (i.e., Usage 3 to 5).</p>
						<p class="tab"><strong>Example 1: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)</a> returns a specific observation in the datastream.</p>
						<p class="tab"><strong>Example 2: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)/Time">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)/Time</a> turns the "Time" property of the specified observation in the datastream.</p>
						<p class="tab"><strong>Example 3: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)/FeatureOfInterest">http://demo.student.geocens.ca:8080/SWIOT_V1.0/Datastreams(1)/Observations(1)/FeatureOfInterest</a> returns the feature of interest entity of the specified observation in the datastream.</p>
					</section>
					<section id="QueryOptions">
						<h3>2.2 Query Options</h3>
						<p class="lead">When users perform the READ action on resource(s), users can apply query options to further process the addressed resources. As the read action is performed through HTTP GET method, the query options are specified as key-value pairs after the question symbol "?" in the request URI. Currently, many of the query options defined in the OGC SensorThings API are similar to the query options in the OData. Therefore, some of the following explanations can be referenced to the OData specification.</p>

						<p class="alert alert-error">NOTE: As our reference implementation hasn't supported all the functions proposed here, we use some examples from the OData test service (http://services.odata.org) to illustrate these functions. As OData might change their demo service, you might find some of the following OData examples not working. And some of the functions, there are no examples available, and these examples uses a pseudo-service root URL (e.g., http://example.com/)</p>



					</section>
					<section id="orderby_query">
						<h4>2.2.1 $orderby</h4>
						<p>The $orderby query option is used to specify which properties are used to order the collection of entities identified by the resource path. This query option is only supported when the resource path identifies a collection of entries. The value of the $orderby query option contains a comma separated list of expressions whose primitive result values are used to sort the results. A special case of such an expression is a property path terminating on a primitive property.</p>
						<p>The expression may include the suffix <i>asc</i> for ascending or <i>desc</i> for descending, separated from the property name by one or more spaces. If asc or desc is not specified, the service must order by the specified property in ascending order.</p>
						<p>Null values come before non-null values when sorting in ascending order and after non-null values when sorting in descending order.</p>
						<p><strong>Example 1: </strong><a href="http://services.odata.org/V3/OData/OData.svc/V3/OData/OData.svc/Products?$orderby=Rating">http://services.odata.org/V3/OData/OData.svc/Products?$orderby=Rating</a> returns all Products ordered by the Rating property in ascending order.</p>
						<p><strong>Example 2: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$orderby=Rating,Category/Name%20desc">http://services.odata.org/V3/OData/OData.svc/Products?$orderby=Rating,Category/Name desc</a> returns all Products ordered by the Rating property in ascending order, then by the Name property of the linked Category entry in descending order.</p>
					</section>
					<section id="top_query">
						<h4>2.2.2 $top</h4>
						<p>The $top query option specifies a non-negative integer that limits the number of entities returned within a collection. The service must return the number of available entities up to, but not exceeding, the specified value.</p>
						<p>Usually, the $top query option is used with the $orderby query option. However, while no ordering semantics are mandated, to ensure repeatable results, a data service must always use the same semantics to obtain a full ordering across requests.</p>
						<p>In addition, if the $top value exceeds the service-driven pagination limitation (i.e., the largest number of entities the service can return in a single response), the $top query option should be discarded and the pagination limitation should be imposed.</p>
						<p><strong>Example 1: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$top=5">http://services.odata.org/V3/OData/OData.svc/Products?$top=5</a> returns only the first five entities in the Products collection.</p>
						<p><strong>Example 2: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$top=5&$orderby=Name%20desc">http://services.odata.org/V3/OData/OData.svc/Products?$top=5&$orderby=Name desc</a> returns the first five Product entries returned in descending order when sorted by the Name property.</p>
					</section>
					<section id="skip_query">
						<h4>2.2.3 $skip</h4>
						<p>The $skip query option specifies that the result must not include the first <var>n</var> entities, where n is a non-negative integer value specified by the $skip query option.</p>
						<p>Usually, the $skip query option is used with the $orderby query option. However, while no ordering semantics are mandated, to ensure repeatable results, a data service must always use the same semantics to obtain a full ordering across requests.</p>
						<p>Where $top and $skip are used together, the $skip must be applied before the $top, regardless of the order in which they appear in the request.</p>
						<p><strong>Example 1: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$skip=5">http://services.odata.org/V3/OData/OData.svc/Products?$skip=5</a> returns Product entities starting with the sixth Product entity in the Products collection.</p>
						<p><strong>Example 2: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$skip=2&$top=2&$orderby=Rating">http://services.odata.org/V3/OData/OData.svc/Products?$skip=2&$top=2&$orderby=Rating</a> returns the third and fourth Product entities from the collection of all Product entities when the collection is sorted by the Rating property in ascending order.</p>
					</section>
					<section id="filter_query">
						<h4>2.2.4 $filter</h4>
						<p>A URI with a $filter query option identifies a subset of the entries from the collection of entries identified by the resource path of the URI. The subset is determined by selecting only the entries that satisfy the predicate expression specified by the $filter. The value of the $filter option is a Boolean expression.</p>
						<p>The expression language that is used in $filter operators supports references to properties and literals. The literal values can be strings enclosed in single quotes, numbers and boolean values (true or false) or datetime values represented as datetime'ISO 8601 time string'.</p>
						<p><strong>Example: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$filter=Price lt 10.00">http://services.odata.org/V3/OData/OData.svc/Products?$filter=Price lt 10.00</a> returns all Products whose Price is less than 10.00.</p>
						<p>In addition, users may use the properties of linked entities in the $filter predicate. The following are examples of the possible uses of the $filter in the data model of the SensorThings service.</p>
						<p><strong>Example 1: </strong><a href="http://example.com/Observations?$filter=ObservedProperty/UnitOfMeasurement eq 'Celsius'">ttp://iot-rest.example.com/Observations?$filter=ObservedProperty/UnitOfMeasurement eq 'Celsius'</a> returns all Observations whose UnitOfMeasurement (a property of ObservedProperty) is 'Celsius'.</p>
						<p><strong>Example 2: </strong><a href="http://example.com/Things?$filter=Locations/Geometry st_within(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)))">http://iot-rest.example.com/Things?$filter=Locations/Geometry st_within(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)))</a> returns Things whose current or past locations were in the polygon defined in the Well-Known Text (WKT).</p>
						<p><strong>Example 3: </strong><a href="http://example.com/ Things?$filter=Sensors/Observations/FeatureOfInterest/ID eq 'FOI_1' and Sensors/Observations/Time ge datetime'2010-06-01T00:00:00Z' and Sensors/Observations/Time le datetime'2010-07-01T00:00:00Z'">http://iot-rest.example.com/ Things?$filter=Sensors/Observations/FeatureOfInterest/ID eq 'FOI_1' and Sensors/Observations/Time ge datetime'2010-06-01T00:00:00Z' and Sensors/Observations/Time le datetime'2010-07-01T00:00:00Z'</a> returns Things that made any observations on a feature of interest with a unique identifier equals to 'FOI_1' in June 2010.</p>
					</section>
					<section id="filterOperations">
						<h5>2.2.4.1 Built-in filter operations</h5>
						<p>The OGC SensorThings API supports a set of built-in filter operations, as described in the following table.</p>
						<br/>
<table class="table table-striped">
<thead>
							<tr>
								<th>Operator</th>
								<th>Description</th>
								<th>Example</th>
							</tr>
							<tr>
								<th align="left" colspan="3">Logical Operators</th>
							</tr>
</thead>
							<tr>
								<td>eq</td>
								<td>Equal</td>
								<td>/Suppliers?$filter=Address/City eq 'Redmond'</td>
							</tr>
							<tr>
								<td>ne</td>
								<td>Not equal</td>
								<td>/Suppliers?$filter=Address/City ne 'London'</td>
							</tr>
							<tr>
								<td>gt</td>
								<td>Greater than</td>
								<td>/Products?$filter=Price gt 20</td>
							</tr>
							<tr>
								<td>ge</td>
								<td>Greater than or equal</td>
								<td>/Products?$filter=Price ge 10</td>
							</tr>
							<tr>
								<td>lt</td>
								<td>Less than</td>
								<td>/Products?$filter=Price lt 20</td>
							</tr>
							<tr>
								<td>le</td>
								<td>Less than or equal</td>
								<td>/Products?$filter=Price le 100</td>
							</tr>
							<tr>
								<td>and</td>
								<td>Logical and</td>
								<td>/Products?$filter=Price le 200 and Price gt 3.5</td>
							</tr>
							<tr>
								<td>or</td>
								<td>Logical or</td>
								<td>/Products?$filter=Price le 3.5 or Price gt 200</td>
							</tr>
							<tr>
								<td>not</td>
								<td>Logical negation</td>
								<td>/Products?$filter=not endswith(Description,'milk')</td>
							</tr>
							<tr>
								<th align="left" colspan="3">Arithmetic Operators</th>
							</tr>
							<tr>
								<td>add</td>
								<td>Addition</td>
								<td>/Products?$filter=Price add 5 gt 10</td>
							</tr>
							<tr>
								<td>sub</td>
								<td>Subtraction</td>
								<td>/Products?$filter=Price sub 5 gt 10</td>
							</tr>
							<tr>
								<td>mul</td>
								<td>Multiplication</td>
								<td>/Products?$filter=Price mul 2 gt 2000</td>
							</tr>
							<tr>
								<td>div</td>
								<td>Division</td>
								<td>/Products?$filter=Price div 2 gt 4</td>
							</tr>
							<tr>
								<td>mod</td>
								<td>Modulo</td>
								<td>/Products?$filter=Price mod 2 eq 0</td>
							</tr>
							<tr>
								<th align="left" colspan="3">Grouping Operators</th>
							</tr>
							<tr>
								<td>( )</td>
								<td>Precedence grouping</td>
								<td>/Products?$filter=(Price sub 5) gt 10</td>
							</tr>
						</table>
						<br/>
					</section>
					<section id="queryFunctions">
						<h5>2.2.4.2 Built-in query functions</h5>
						<p>SensorThings API supports a set of built-in functions that can be used within $filter operations. The following table lists the available functions. Most of these query functions are defined in the OData. However, in order to support more geospatial query functions, SensorThings API defines nine additional geospatial functions based on the spatial relationship between two geometry objects defined in the OGC Simple Feature Access specification (part 1, clause 6.1.2.3). The names of these nine functions start with a prefix "st_" as they are named in the OGC Simple Feature Access specification. In addition, for these eight functions, we define that users must specify input geometry in the Well-Known Text (WKT) format.</p>
						<br/>
<table class="table table-striped">
<thead>
							<tr>
								<th>Function</th>
								<th>Example</th>
							</tr>
							<tr>
								<th align="left" colspan="2">String Functions</th>
							</tr>
							</thead>
							<tr>
								<td>bool substringof</td>
								<td>substringof('Alfreds',CompanyName)</td>
							</tr>
							<tr>
								<td>bool endswith</td>
								<td>endswith(CompanyName,'Futterkiste')</td>
							</tr>
							<tr>
								<td>bool startswith</td>
								<td>startswith(CompanyName,'Alfr')</td>
							</tr>
							<tr>
								<td>int length</td>
								<td>length(CompanyName) eq 19</td>
							</tr>
							<tr>
								<td>int indexof</td>
								<td>indexof(CompanyName,'lfreds') eq 1</td>
							</tr>
							<tr>
								<td>string substring</td>
								<td>substring(CompanyName,1) eq 'lfreds Futterkiste'</td>
							</tr>
							<tr>
								<td>string tolower</td>
								<td>tolower(CompanyName) eq 'alfreds futterkiste'</td>
							</tr>
							<tr>
								<td>string toupper</td>
								<td>toupper(CompanyName) eq 'ALFREDS FUTTERKISTE'</td>
							</tr>
							<tr>
								<td>string trim</td>
								<td>trim(CompanyName) eq 'Alfreds Futterkiste'</td>
							</tr>
							<tr>
								<td>string concat</td>
								<td>concat(concat(City,', '), Country) eq 'Berlin, Germany'</td>
							</tr>
							<thead>
							<tr>
								<th align="left" colspan="2">Date Functions</th>
							</tr>
							</thead>
							<tr>
								<td>DateTime now</td>
								<td>StartTime ge now()</td>
							</tr>
							<tr>
								<td>int year</td>
								<td>year(BirthDate) eq 0</td>
							</tr>
							<tr>
								<td>int month</td>
								<td>month(BirthDate) eq 12</td>
							</tr>
							<tr>
								<td>int day</td>
								<td>day(StartTime) eq 8</td>
							</tr>
							<tr>
								<td>int hour</td>
								<td>hour(StartTime) eq 1</td>
							</tr>
							<tr>
								<td>int minute</td>
								<td>minute(StartTime) eq 0</td>
							</tr>
							<tr>
								<td>int second</td>
								<td>second(StartTime) eq 0</td>
							</tr>
							<tr>
								<td>double fractionalseconds</td>
								<td>second(StartTime) eq 0</td>
							</tr>
							<tr>
								<td>Date date</td>
								<td>date(StartTime) ne date(EndTime)</td>
							</tr>
							<tr>
								<td>TimeOfDay time</td>
								<td>time(StartTime) le StartOfDay</td>
							</tr>
							<tr>
								<td>int totaloffsetminutes</td>
								<td>totaloffsetminutes(StartTime) eq 60</td>
							</tr>
							<tr>
								<td>DateTimeOffset mindatetime</td>
								<td>StartTime eq mindatetime()</td>
							</tr>
							<tr>
								<td>DateTimeOffset maxdatetime</td>
								<td>EndTime eq maxdatetime()</td>
							</tr>
							<thead>
							<tr>
								<th align="left" colspan="2">Math Functions</th>
							</tr>
							</thead>
							<tr>
								<td>double round</td>
								<td>round(Freight) eq 32</td>
							</tr>
							<tr>
								<td>double floor</td>
								<td>floor(Freight) eq 32</td>
							</tr>
							<tr>
								<td>double ceiling</td>
								<td>ceiling(Freight) eq 33</td>
							</tr>
							<thead>
							<tr>
								<th align="left" colspan="2">Type Functions</th>
							</tr>
							</thead>
							<tr>
								<td>any cast</td>
								<td>cast(ShipCountry,Edm.String)</td>
							</tr>
							<tr>
								<td>bool isof</td>
								<td>isof(NorthwindModel.Order)</td>
							</tr>
							<tr>
								<td>bool isof</td>
								<td>isof(ShipCountry,Edm.String)</td>
							</tr>
							<thead>
							<tr>
								<th align="left" colspan="2">Geospatial Functions</th>
							</tr>
							</thead>
							<tr>
								<td>double geo.distance</td>
								<td>geo.distance(CurrentPosition, TargetPosition)</td>
							</tr>
							<tr>
								<td>double geo.length</td>
								<td>geo.length(DirectRoute)</td>
							</tr>
							<tr>
								<td>bool geo.intersects</td>
								<td>geo.intersects(Position, TargetArea)</td>
							</tr>
							<tr>
								<td>bool st_equals</td>
								<td>st_equals(POINT (30 10))</td>
							</tr>
							<tr>
								<td>bool st_disjoint</td>
								<td>st_disjoint(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)))</td>
							</tr>
							<tr>
								<td>bool st_touches</td>
								<td>st_touches(LINESTRING (30 10, 10 30, 40 40))</td>
							</tr>
							<tr>
								<td>bool st_within</td>
								<td>st_within(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)))</td>
							</tr>
							<tr>
								<td>bool st_overlaps</td>
								<td>st_overlaps(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)))</td>
							</tr>
							<tr>
								<td>bool st_crosses</td>
								<td>st_crosses(LINESTRING (30 10, 10 30, 40 40))</td>
							</tr>
							<tr>
								<td>bool st_intersects</td>
								<td>st_intersects(LINESTRING (30 10, 10 30, 40 40))</td>
							</tr>
							<tr>
								<td>bool st_contains</td>
								<td>st_contains(POINT (30 10))</td>
							</tr>
							<tr>
								<td>bool st_relate</td>
								<td>st_relate(POLYGON ((30 10, 10 20, 20 40, 40 40, 30 10)), 'T********')</td>
							</tr>
						</table>
						<br/>
					</section>
					<section id="expand_query">
						<h4>2.2.5 $expand</h4>
						<p>The $expand system query option indicates the related entities that must be represented inline. The value of the $expand query option must be a comma separated list of navigation property names. Additionally each navigation property can be followed by a forward slash and another navigation property to enable identifying a multi-level relationship.</p>
						
						<p><strong>Example 1: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Categories?$expand=Products">http://services.odata.org/V3/OData/OData.svc/Categories?$expand=Products</a> returns the collection of Categories as well as each of the Products associated with each Category entity.</p>
						<p><strong>Example 2: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Categories?$expand=Products/Suppliers">http://services.odata.org/V3/OData/OData.svc/Categories?$expand=Products/Suppliers</a> returns the collection of Categories, the Products associated with each Category, and the Suppliers associated with each Product.</p>
						<p><strong>Example 3: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$expand=Category,Suppliers">http://services.odata.org/V3/OData/OData.svc/Products?$expand=Category,Suppliers</a> returns the collection of Products as well as the Category and Suppliers associated with each Product.</p>
					</section>
					<section id="select_query">
						<h4>2.2.6 $select</h4>
						<p>A data service URI with a $select query option identifies the same set of entries as a URI without a $select query option; however, the value of $select specifies that a response from an SensorThings service should return a subset of the properties. The value of a $select query option is a comma-separated list of selection clauses. Each selection clause may be a property name (including navigation property names).</p>
						<p><strong>Example 1: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$select=Price,Name">http://services.odata.org/V3/OData/OData.svc/Products?$select=Price,Name</a> returns only the Price and Name properties for each Product entity.</p>
						<p><strong>Example 2: </strong><a href="http://service.odata.org/Categories?$select=Name,Products&$expand=Products/Supplier">http://service.odata.org/Categories?$select=Name,Products&$expand=Products/Supplier</a> returns the Name properties of the Category entries, and all the properties of the entries identified by the Products and Suppliers navigation properties.</p>
					</section>
					<section id="count_query">
						<h4>2.2.7 $count</h4>
						<p>The $count query option with a value of "true" specifies that the total count of entities within a collection matching the request must be returned along with the result. The $count system query option ignores any $top, $skip, or $expand query options, and returns the total count of results across all pages including only those results matching any specified $filter.</p>
						<p>A $count with a value of "false" (or not specified) hints that the service should not return a count.</p>
						<p><strong>Example: </strong><a href="http://services.odata.org/V3/OData/OData.svc/Products?$count=true">http://services.odata.org/V3/OData/OData.svc/Products?$count=true</a> returns, along with the results, the total number of products in the set.</p>
					</section>
				</section>
				<section id="capabilities">
					<h2>3. $capabilities</h2>
					<p class="lead">This operation allows clients to retrieve the service metadata about a specific service instance. The $select is the only query option can be applied here. So users can only request for a partial of the capabilities document.</p>
					<section id="request_capabilities">
						<h3>3.1 $capabilities Request</h3>
						<p><strong>HTTP Method: </strong>GET</p>
						<p><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/$capabilities</var></p>
						<p><strong>Example: </strong><a href="http://demo.student.geocens.ca:8080/SWIOT_V1.0/$capabilities">http://demo.student.geocens.ca:8080/SWIOT_V1.0/$capabilities</a></p>
					</section>
					<section id="response_capabilities">
						<h3>3.2 $capabilities Response</h3>
						<p>The capabilities document is a JSON encoded document. This document provides client with service metadata about a specific service instance. A service should use the capabilities document to advertise the supported functions and any constraints on using these functions. A service may also use the capabilities document to showcase the spatio-temporal coverage of the content. Finally, if a service provides any custom operations, the explanation of those operations should be included in the capabilities document as well.</p>
						<p>The detail explanation about the capabilities document can be found in <a href="datamodel.html#capabilities">datamodel.html#capabilities</a>.</p>
					</section>
				</section>
				<section id="DatastreamProfile">
					<h2>4. Sensing Profile</h2>
					<p class="lead">The OGC SensorThings API sensing profile is based on the <a href="http://www.opengeospatial.org/standards/sos">OGC SOS </a>concept and designed specifically for the Internet of Things.</p>
					<p class="lead">As most IoT devices are resource-constrained, the SensorThings API adopts the efficient RESTful web service style. That means the CRUD actions can be performed on <a href="datamodel.html#Thing">Thing</a>, <a href="datamodel.html#Location">Location</a>, <a href="datamodel.html#Datastream">Datastream</a>, <a href="datamodel.html#Sensor">Sensor</a>, <a href="datamodel.html#Observation">Observation</a>, <a href="datamodel.html#FeatureOfInterest">FeatureOfInterest</a>, and <a href="datamodel.html#ObservedProperty">ObservedProperty</a> entity types. The following subsection explains the CRUD protocol for the Sensing Profile.</p>
				</section>
				<section id="Resources_DatastreamProfile">
					<h3>4.1 Resources in the Sensing Profile</h3>
					<p class="lead">The detail explanation about the resources in the Sensing Profile can be found <a href="datamodel.html#DatastreamProfile">here</a>.</p>
				</section>
				<section id="Create_DatastreamProfile">
					<h3>4.2 Create a Resource in Datastream Profile</h3>
					<p class="lead">To create an entity in a collection, the client sends a HTTP POST request to that collection's URL. The POST body must contain a single valid entity representation. In addition, the link between entities should be established upon creating an entity. Two use cases should be considered: (1) link to existing entities when creating an entity, and (2) create related entities when creating an entity. The requests for these two use cases are also described in the following subsection.</p>
					<p>When users create resources in an SensorThings service, they need to follow some integrity constraints. For example, a Datastream entity must link to a Thing entity. So when a user wants to create a Datastream entity, he/she needs to either (1) create a linked Thing entity in the same request or (2) link to a already created Thing entity. The complete integrity constraints for creating resources are shown in the following table.</p>
					<p>One special case is on creating an Observation entity that links to an FeatureOfInterest entity. Sometimes the FeatureOfInterest of an Observation is the Thing itself where the Observation is similar to an attribute of the Thing. In this cases, when a user creates an Observation entity, he/she can omit the link to a FeatureOfInterest entity in the POST body message. And if the service detects that there is no link to a FeatureOfInterst entity in a create-Observation entity request, the service must automatically create a FeatureOfInterest entity by interpolating the geometry property from the locations of the Thing entity.</p>
					<br/>
<table class="table table-striped">
<thead>
						<tr>
							<th>Scenario</th>
							<th>Integrity Constraints</th>
						</tr>
						</thead>
						<tr>
							<td>Create a Thing entity</td>
							<td>-</td>
						</tr>
						<tr>
							<td>Create a Location entity</td>
							<td>Link to a Thing entity.</td>
						</tr>
						<tr>
							<td rowspan="2">Create a Datastream entity</td>
							<td>Link to a Thing entity.</td>
						</tr>
						<tr>
							<td>Link to an ObservedProperty entity.</td>
						</tr>
						<tr>
							<td>Create a Sensor entity</td>
							<td>Link to a Datastream entity.</td>
						</tr>
						<tr>
							<td>Create an ObservedProperty entity</td>
							<td>-</td>
						</tr>
						<tr>
							<td rowspan="2">Create an Observation entity</td>
							<td>Link to a Datastream entity.</td>
						</tr>
						<tr>
							<td>Link to a FeatureOfInterest entity.<br/>(If no link specified, the service must create a FeatureOfInterest entity from the information of the Thing and Location entities.)</td>
						</tr>
						<tr>
							<td>Create a FeatureOfInterest entity</td>
							<td>-</td>
						</tr>
						<tr>
							<td>Create a TaskingCapability entity</td>
							<td>Link to a Thing entity.</td>
						</tr>
						<tr>
							<td>Create an Actuator entity</td>
							<td>Link to a TaskingCapability entity.</td>
						</tr>
						<tr>
							<td>Create a Task entity</td>
							<td>Link to a TaskingCapability entity.</td>
						</tr>
					</table>
					<br/>

					<p>More examples about the POST body messages for different resources can be found in the <a href="ecosystem.html#InteractiveSDKs">Interactive SDK</a>.</p>
					<section id="Request_Create_DatastreamProfile">
						<h4>4.2.1 Request</h3>
						<p><strong>HTTP Method: </strong>POST</p>
						<p><strong>URI Pattern: </strong><var>SERVICE_ROOT_URI/COLLECTION_NAME</var></p>
						<p><strong>Header: </strong>Content-Type: application/json</p>
						<p><strong>Message Body: </strong>A single valid entity representation for the specified collection.</p>
						<p><strong>Example: </strong>Create a Thing entity</p>
<pre><strong>POST /SWIOT_V0.9/Things HTTP/1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "Description":"This thing is an oven."
}</code></pre>
						<section id="Link_to_existing_entities_when_creating_an_entity">
							<h4>4.2.1.1 Link to Existing Entities when Creating an Entity</h3>
							<p>A service should support linking new entities to existing entities upon creation. To create a new entity with links to existing entities in a single request, the client needs to include the unique identifiers of the related entities associated with the corresponding navigation properties in the request body.</p>
							<p>Note: In the case of creating an observation that measures on the thing itself (i.e., the observation can be interpreted as an attribute of the thing), the request of creating the observation must not include a link to a feature of interest entity. The service will first automatically create a feature of interest entity from the thing and the locations of the thing and then link to the observation.</p>
							<p><strong>Example: </strong>Create an Observation entity, which links to an existing Sensor entity (whose ID is 1), an existing FeatureOfInterest entity (whose ID is 2), and an existing ObservedProperty entity (whose ID is 3).</p>
<pre><strong>POST /SWIOT_V0.9/Observations HTTP/1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "Datastream":{"ID":1},
  "Time":"2013-04-18T16:15:00-0700",
  "ResultValue":"124",
  "ResultType" : "Measure",
  "FeatureOfInterest":{"ID":1}
}</code></pre>
						</section>
						<section id="Create_related_entities_when_creating_an_entity">
							<h4>4.2.1.2 Create Related Entities when Creating an Entity</h3>
							<p>A service that supports creating entities should support creating related entities as part of the same request. A request to create an entity may specify related entities that should also be created. The related entities must be represented using the appropriate inline representation of the navigation property.</p>
							<p>Properties computed by the service, such as unique identifiers of entities, may be omitted from the request. If the inline representation contains a value for a computed or dependent property, the service MUST ignore that value when creating the related entity.</p>
							<p>On success, the service must create each entity and relate them. On failure, the service must not create any of the entities.</p>
							<p><strong>Example: </strong>Create a Thing while creating two related Sensors and one related Observation (which links to an existing FeatureOfInterest entity and an existing ObservedProperty entity).</p>
<pre><strong>POST /SWIOT_V0.9/Things HTTP1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "Description":"This a Thing with one Datastream and one TaskingCapability",
  "Locations":[
  {
    "Geometry":
    {
      "Type":"POINT" ,
      "Coordinates" :[10,10]
    },
	"Time":"2013-04-18T16:15:00-0700"
  }],
  "TaskingCapabilities":[
  {
    "Description":"this is TaskingCapability 1",
    "Parameters":[
    {
      "ParameterID":"paramOn",
      "Description":"on",
      "Use":"mandatory",
      "Definition":
      {
        "InputType":"Integer",
        "UnitOfMeasurement":"brightness degrees",
        "AllowedValues":[{"Min":"10","Max":"15"}]
      }
    }],
    "Protocols":[
    {
      "HTTPMethod":"POST",
      "AbsoluteResourcePath":"http://path.com",
      "MessageBody":"lamp-id=1&on={paramOn}"
    }],
    "Actuator":
    {
      "Metadata":"This is an actuator"
    }
  }],
  "Datastreams":[
  {
    "Description":"this is datastream one",
    "Observations":[
    {
      "Time":"2013-04-18T16:15:00-0700",
      "ResultValue":"124",
      "ResultType" : "Measure",
      "FeatureOfInterest":
      {
        "Description":"foi_desc",
        "Geometry":{
          "Type":"POLYGON" ,
          "Coordinates": [[[100,50],[10,9],[23,4],[100,50]],[[30,20],[10,4],[4,22],[30,20]]]
        }
      }
    }],
    "ObservedProperty":
    {
      "UnitOfMeasurement":"uom_test",
      "URN":"sample URN"
    },
    "Sensor":
    {
      "Metadata":"This is a sensor"
    }
  }]
}</code></pre>
						</section>
					</section>
					<section id="Response_Create_DatastreamProfile">
						<h4>4.2.2 Response</h3>
						<p>Upon successfully creating an entity, the service response must contain a Location header that contains the URL of the created entity. Upon successful completion the service must respond with 201 Created. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
					</section>
				</section>
				<section id="Read_DatastreamProfile">
					<h3>4.3 Read a Resource in Datastream Profile</h3>
					<section id="Request_Read_DatastreamProfile">
						<h4>4.3.1 Request</h3>
						<p><strong>HTTP Method: </strong>GET</p>
						<p><strong>URI Pattern: </strong>Refer to the <a href="#URIComponents">URIComponents</a> section, including resource path and query options</p>
					</section>
					
					<section id="Response_Read_DatastreamProfile">
						<h4>4.3.2 Response</h3>
						<p>The detail explanation about the encodings of resources in the datastream profile can be found in <a href="datamodel.html#DatastreamProfile">datamodel.html#DatastreamProfile</a>.</p>
						<p>Upon successfully retrieve resources, the service service must respond with 200 OK. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
					</section>
				</section>
				<section id="Update_DatastreamProfile">
					<h3>4.4 Update a Resource in Datastream Profile</h3>
					<section id="Request_Update_DatastreamProfile">
						<h4>4.4.1 Request</h3>
						<p>Services should support HTTP PATCH as the preferred means of updating an entity. HTTP PATCH provides more resiliencies between clients and services by directly modifying only those values specified by the client.</p>
						<p>The semantics of PATCH, as defined in [RFC5789], are to merge the content in the request payload with the entity's current state, applying the update only to those components specified in the request body. Collection properties and primitive properties provided in the payload must replace the value of the corresponding property in the entity or complex type. Missing properties of the containing entity or complex property, including dynamic properties, must not be directly altered.</p>
						<p>Services may additionally support HTTP PUT, but should be aware of the potential for data-loss in round-tripping properties that the client may not know about in advance. Services that support HTTP PUT must replace all property values with those specified in the request body. Missing properties must be set to their default values. Missing optional properties must be removed.</p>
						<p>Unique identifiers and other non-updatable properties may be omitted from the request. If the request contains a value for an identifier or other non-updatable property, the service must ignore that value when applying the update.</p>
						<p>The entity must not contain related entities as inline content. Additional values for properties beyond those specified in the SensorThings data model should not be sent in the request body. The service should consider such a request malformed.</p>
						<p><strong>HTTP Method: </strong>PATCH or PUT</p>
						<p><strong>URI Pattern: </strong>An URI addressing to a single entity.</p>
						<p><strong>Header: </strong>Content-Type: application/json</p>
						<p><strong>Message Body: </strong>A single entity representation including a subset of properties for the specified collection.</p>
						<p><strong>Example: </strong>Update the Thing with key equals to 1</p>
<pre><strong>PATCH /SWIOT_V0.9/Things(1) HTTP1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "Description":"This thing is an oven own by the Toms."
}</code></pre>
					</section>
					
					<section id="Response_Update_DatastreamProfile">
						<h4>4.4.2 Response</h3>
						<p>On success, the response must be a valid success response. In addition, when the client sends an update request to a valid URL where an entity does not exist, the service must fail the request.</p>
						<p>Upon successful completion, the service service must respond with 200 OK or 204 No Content. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
					</section>
				</section>
				<section id="Delete_DatastreamProfile">
					<h3>4.5 Delete a Resource in Datastream Profile</h3>
					<section id="Request_Delete_DatastreamProfile">
						<h4>4.5.1 Request</h3>
						<p>To delete an existing entity, the client sends a HTTP DELETE request to that entity's edit URL. The request body should be empty.</p>
						<p><strong>HTTP Method: </strong>DELETE</p>
						<p><strong>URI Pattern: </strong>An URI addressing to a single entity.</p>
						<p><strong>Example: </strong>Delete the Thing with unique identifier equals to 1</p>
						<pre><strong>HTTP DELETE http://demo.student.geocens.ca:8080/SWIOT_V1.0/Things(1)</strong></pre>
						<p>Services must implicitly remove relations to and from an entity when deleting it; clients need not delete the relations explicitly.</p>
						<p>Services should implicitly delete related entities if required by the following integrity constraints.</p>
						<br/>
<table class="table table-striped">
<thead>
							<tr>
								<th>Scenario</th>
								<th>Integrity Constraints</th>
							</tr>
							</thead>
							<tr>
								<td rowspan="3">Delete a Thing entity</td>
								<td>Delete all the Datastream entities linked to the Thing entity.</td>
							</tr>
							<tr>
								<td>Delete all the TaskingCapability entities linked to the Thing entity.</td>
							</tr>
							<tr>
								<td>Delete the Location entities that will not link to any entities after deletion.</td>
							</tr>
							<tr>
								<td>Delete a Location entity</td>
								<td>-</td>
							</tr>
							<tr>
								<td rowspan="2">Delete a Datastream entity</td>
								<td>Delete the Sensor entity linked to the Datastream entity.</td>
							</tr>
							<!--<tr>
								<td>Delete the ObservedProperty entities that will not link to any entities after deletion.</td>
							</tr>-->
							<tr>
								<td>Delete all the Observation entities linked to the Datastream entity.</td>
							</tr>
							<tr>
								<td>Delete a Sensor entity</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Delete an ObservedProperty entity</td>
								<td>Delete all the Datastream entities linked to the ObservedProperty entity.</td>
							</tr>
							<tr>
								<td>Delete an Observation entity</td>
								<td>-</td>
								<!--<td>Delete the FeatureOfInterest entities that will not link to any entities after deletion.</td>-->
							</tr>
							<tr>
								<td>Delete a FeatureOfInterest entity</td>
								<td>Delete all the Observation entities linked to the FeatureOfInterest entity.</td>
							</tr>
							<tr>
								<td>Delete a TaskingCapability entity</td>
								<td>Delete the Actuator entity linked to the TaskingCapability entity.</td>
							</tr>
							<tr>
								<td>Delete an Actuator entity</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Delete a Task entity</td>
								<td>-</td>
							</tr>
						</table>
						<br/>
					</section>
					
					<section id="Response_Delete_DatastreamProfile">
						<h4>4.5.2 Response</h3>
						<p>On successful completion of the delete, the response must be 200 OK, 202 Accepted, or 204 No Content and contain an empty body. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
					</section>
				</section>
				<section id="TaskingCapabilityProfile">
					<h2>5. TaskingCapability Profile</h2>
					<p>The SensorThings TaskingCapability profile is mainly for users to control actuators through a unified web service interface. There are two major parts in the TaskingCapability profile. The first part is to convey the acceptable parameters of an actuator and allow users to submit controlling tasks through a RESTful interface. The second part in the TaskingCapability profile is to allow SensorThings services to communicate with actuators that are attached to things. Therefore, the following two functionalities should be supported: (1) data producers describing and registering the protocol to communicate with the device; and (2) SensorThings services creating requests and understanding response with the registered device protocol.</p>
					<p>The potential workflow would be (1) a thing (a data producer) creates itself and an actuator attached to it in an SensorThings service, (2) a user retrieves the capabilities document from the SensorThings service, (3) the user retrieves the actuator resource and understands the acceptable parameters of the actuator, (4) with the parameter information, the user creates a task entity (like creating other resources in the SensorThings servie) with specified input values for parameters and the time that the user wants this task to be executed, (5) after the user creates the task in the SensorThings service, the SensorThings service creates a request in the device protocol based on user's input value and sends the request to the thing at the user-specified time, (6) the thing then executes the request and returns a response to the SensorThings service in the device protocol, and finally, (7) the SensorThings service parses the response and updates the status property in the user-created task entity.</p>
					<p>To sum up, the concept of the SensorThings TaskingCapability profile is to provide a RESTful interface for users to submit tasks to control actuators. As SensorThings services handle the communication in device protocols, users can easily control Internet of Things with a simple and unified RESTful interface.</p>
				</section>
				<section id="Resources_TaskingCapabilityProfile">
					<h3>5.1 Resources in Actuator Profile</h3>
					<p>The detail explanation about the resources in the taskingCapability profile can be found in <a href="datamodel.html#TaskingCapabilityProfile">datamodel.html#TaskingCapabilityProfile</a>.</p>
				</section>
				<section id="Create_TaskingCapabilityProfile">
					<h3>5.2 Create a Resource in Actuator Profile</h3>
					<p>The protocol of creating a resource in the taskingCapability profile is similar to that in the datastream profile (<a href="api.html#Create_DatastreamProfile">api.html#Create_DatastreamProfile</a>). Only when creating a taskingCapability entity, the request needs to specify the device protocol (<a href="datamodel.html#TaskingCapability">datamodel.html#TaskingCapability</a>), which is not visible to users in the Read response.</p>
					<p><strong>Example: </strong>Create a TaskingCapability entity</p>
<pre><strong>POST /SWIOT_V0.9/TaskingCapabilities HTTP/1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "Thing":{"ID":1},
  "Description":"this is TaskingCapability 1",
  "Parameters":[
  {
    "ParameterID":"paramOn",
    "Description":"on",
    "Use":"mandatory",
    "Definition":
    {
      "InputType":"Integer",
      "UnitOfMeasurement":"brightness degrees",
      "AllowedValues":[{"Min":"10","Max":"15"}]
    }
  }],
  "Protocols":[
  {
    "HTTPMethod":"POST",
    "AbsoluteResourcePath":"http://path.com",
    "MessageBody":"lamp-id=1&on={paramOn}"
  }],
  "Actuator":
  {
    "Metadata":"This is an actuator"
  }
}</code></pre>
					<p>In addition, the behavior of creating a task entity is the same as submitting a tasking job to the thing. The SensorThings service will compose a request in the device protocol (from the protocol property in the TaskingCapability entity), and send the request at the specified time point. While composing a request in a device protocol, the values of inputs in the task entity will be used to replace the "{ParameterID}" in the device protocol. For instance, the following example requires an SensorThings service to replace "{paramOn}" string in the device protocol with the input value 200. Therefore, with the above taskingCapability entity, the SensorThings service will send a HTTP POST reqeust to http://path.com with a messageBody as "lamp-id=1&on=200" at 2013-04-18T16:15:00-0700.</p>
					<p>When creating a task entity, if the value of <var>Time</var> property is in the past, the task should be sent to the thing immediately.</p>
					<p><strong>Example: </strong>Create a Task entity</p>
<pre><strong>POST /SWIOT_V0.9/Tasks HTTP/1.1</strong>
<strong>Host: </strong>demo.student.geocens.ca:8080
<strong>Content-Type: </strong>application/json
<code>
{
  "TaskingCapability":{"ID":5},
  "Inputs":[
  {
    "ParameterID":"paramOn",
    "Value":200
  }],
  "Time":"2013-04-18T16:15:00-0700"
}</code></pre>
					<p>Upon successfully creating an entity, the service response must contain a Location header that contains the URL of the created entity. Upon successful completion the service must respond with 201 Created. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
				</section>
				<section id="Read_TaskingCapabilityProfile">
					<h3>5.3 Read a Resource in Actuator Profile</h3>
					<p>The protocol of reading a resource in the TaskingCapability profile is the same as that in the Datastream profile (<a href="api.html#Read_DatastreamProfile">api.html#Read_DatastreamProfile</a>). The only exception is that when reading a TaskingCapability entity, the device protocol is not visible to users in the response.</p>
					<p>The detail explanation about the encodings of resources in the TaskingCapability profile can be found in <a href="datamodel.html#TaskingCapabilityProfile">datamodel.html#TaskingCapabilityProfile</a>.</p>
					<p>Upon successfully retrieve resources, the service service must respond with 200 OK. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
				</section>
				<section id="Update_TaskingCapabilityProfile">
					<h3>5.4 Update a Resource in Actuator Profile</h3>
					<p>The protocol of updating a resource in the TaskingCapability profile is the same as that in the Datastream profile (<a href="api.html#Update_DatastreamProfile">api.html#Update_DatastreamProfile</a>). Only the <var>Status</var> property in a Task entity is a service-controlled property and cannot be updated by users. SensorThings service updates the status based on responses from the thing.</p>
					<p>Upon successful completion, the service service must respond with 200 OK or 204 No Content. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
				</section>
				<section id="Delete_TaskingCapabilityProfile">
					<h3>5.5 Delete a Resource in Actuator Profile</h3>
					<p>The protocol of deleting a resource in the TaskingCapability profile is the same as that in the Datastream profile (<a href="api.html#Delete_DatastreamProfile">api.html#Delete_DatastreamProfile</a>). When deleting a Task entity that hasn't been triggered, the service must remove the corresponding thread of sending task as well.</p>
					<p>On successful completion of the delete, the response must be 200 OK, 202 Accepted, or 204 No Content and contain an empty body. Regarding all the HTTP status code, please refer to the <a href="#StatusCode">HTTP Status Code</a> section.</p>
				</section>
				<section id="BatchProcessing">
					<h2>6. Batch Processing</h2>
					<p>The SensorThings service interface provides interfaces for users to perform CRUD actions on resources through different HTTP methods. However, as IoT devices are usually resource-constrained, handling a large number of communications may be not practical. This section describes how an SensorThings service can optionally support executing multiple operations sent in a single HTTP request through the use of batch processing. This section covers both how batch operations are represented and processed.</p>
					<section id="Request_BatchProcessing">
						<h3>6.1 Request</h3>
						<p>A batch request is represented as a Multipart MIME v1.0 message [RFC2046], a standard format allowing the representation of multiple parts, each of which may have a different content type, within a single request.</p>
						
						<section id="Headers_Request_BatchProcessing">
							<h4>6.1.1 Headers</h4>
							<p>Batch requests allow grouping multiple operations, as described in <a href="api.html#DatastreamProfile">DatastreamProfile</a> and <a href="api.html#TaskingCapabilityProfile">TaskingCapabilityProfile</a>, into a single HTTP request payload.</p>
							<p>Batch Requests are submitted as a single HTTP POST request to the $batch endpoint of a service. The batch request must contain a Content-Type header specifying a content type of "multipart/mixed" and a boundary specification. The example below shows a GUID as a boundary and "OData/OData.svc"for the URI of the service. <Batch Request Body> is defined in the Batch Request Body section below.</p>
<pre><strong>POST OData/OData.svc/$batch HTTP/1.1</strong>
<strong>Host: </strong>services.odata.org
<strong>DataServiceVersion: </strong>1.0
<strong>MaxDataServiceVersion: </strong>2.0
<strong>Content-Type: </strong>multipart/mixed; boundary=batch(36522ad7-fc75-4b56-8c71-56071383e77b)
<code>
<var>BATCH_REQUEST_BODY</var></code></pre>
							<p>The batch request boundary must be quoted if it contains any of the following special characters:</p>
<pre><code>( ) < > @ , ; : / " [ ] ? =</code></pre>
							<p>In addition to the Content-Type header, the Batch request may contain DataServiceVersion headers or other HTTP Headers which apply to the entire Batch Request as appropriate. In the example above, DataServiceVersion has a value of 1.0 representing the version of the OData specification used to generate the request, and MaxDataServiceVersion has a value of 2.0 representing the maximum response version the client is prepared to accept.</p>
						</section>
						<section id="Body_Request_BatchProcessing">
							<h4>6.1.2 Message Body</h4>
							<p>The body of a Batch Request is made up of an ordered series of retrieve operations (as described in [OData-Operations] ) and/or ChangeSets. A ChangeSet is an atomic unit of work that is made up of an unordered group of one or more of the insert, update or delete operations described in < a href="/developers/protocols/operations">[OData:Operations]. ChangeSets cannot contain retrieve requests and cannot be nested (i.e. a ChangeSet cannot contain a ChangeSet).</p>
							<p>In the Batch request body, each retrieve request and ChangeSet is represented as a distinct MIME part and is separated by the boundary marker defined in the Content-Type header of the request. The contents of the MIME part which represents a ChangeSet is itself a multipart MIME document with one part for each operation that makes up the ChangeSet.</p>
							<p>Each MIME part representing a retrieve request or ChangeSet within the Batch includes both Content-Type and Content-Transfer-Encoding MIME headers as seen in the examples below. The batch request boundary is the name specified in the Content-Type Header for the batch.</p>
							<p>The example below shows a sample batch request that contains the following operations in the order listed:</p>
							<ul>
								<li>Retrieve</li>
								<li>A Change Set that contains the following requests:
								<ul>
									<li>Insert</li>
									<li>Update</li>
								</ul>
								</li>
								<li>A second retrieve request</li>
							</ul>
							<p>Note: In the example, request bodies are excluded in favor of English descriptions inside '<>' brackets to simplify the example.</p>
<pre><strong>POST OData/OData.svc/$batch HTTP/1.1</strong>
<strong>Host: </strong>services.odata.org
<strong>Content-Type: </strong>multipart/mixed; boundary=batch(36522ad7-fc75-4b56-8c71-56071383e77b)
<code>
--batch_36522ad7-fc75-4b56-8c71-56071383e77b
Content-Type: application/http 
Content-Transfer-Encoding:binary

GET /service/Customers('ALFKI') HTTP/1.1
Host: host

--batch_36522ad7-fc75-4b56-8c71-56071383e77b 
Content-Type: multipart/mixed; boundary=changeset_77162fcd-b8da-41ac-a9f8-9357efbbd621 
Content-Length: ###       

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621) 
Content-Type: application/http 
Content-Transfer-Encoding: binary 

POST /service/Customers HTTP/1.1 
Host: host  
Content-Type: application/atom+xml;type=entry 
Content-Length: ### 

<AtomPub representation of a new Customer> 

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621) 
Content-Type: application/http 
Content-Transfer-Encoding:binary 

PUT /service/Customers('ALFKI') HTTP/1.1 
Host: host 
Content-Type: application/json 
If-Match: xxxxx 
Content-Length: ### 

<JSON representation of Customer ALFKI> 

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621)-- 

--batch(36522ad7-fc75-4b56-8c71-56071383e77b) 
Content-Type: application/http 
Content-Transfer-Encoding:binary 

GET service/Products HTTP/1.1 
Host: host 

--batch(36522ad7-fc75-4b56-8c71-56071383e77b)--</code></pre>
							<p>If a MIME part representing an Insert request within a ChangeSet includes a Content-ID header, then the new entity may be referenced by subsequent requests within the same ChangeSet by referring to the Content-ID value prefixed with a "$" character. When used in this way, $<contentIdValue> acts as an alias for the Resource Path that identifies the new entity.</p>
						</section>
					</section>
					<section id="Process_BatchProcessing">
						<h3>6.2 Process a Batch Request</h3>
						<p>Requests within a batch are evaluated according to the same semantics used when the request appears outside of the context of a batch.</p>
						<p>The order of ChangeSets and retrieve requests within a Batch request is significant as it states the order in which the service processes the components of the Batch.  The order of requests within a ChangeSet is not significant such that a service may process the requests within a ChangeSet in any order.</p>
						<p>All operations in a ChangeSet represent a single change unit so the server must successfully process and apply all the requests in the ChangeSet or else apply none of the requests in the ChangeSet.  It is up to the service to define rollback semantics to undo any requests within a ChangeSet that may have been applied before another request in that same ChangeSet failed and thereby honor this all-or-nothing requirement.</p>
						<p>If the set of HTTP Request headers of a Batch request are valid (the Content-Type is set to multipart/mixed, etc.) the server returns a 202 Accepted HTTP response code to indicate that the request has been accepted for processing, but that the processing has not yet been completed. The requests within the Batch request body may subsequently fail or be malformed; however, this mechanism enables clients of a Batch implementation to stream the results of a Batch request without having to first wait for all requests to be processed.</p>
						<p>If the service receives a Batch request with an invalid set of headers it returns a 4xx response code and no further processing of the batch is performed.</p>
					</section>
					<section id="Response_BatchProcessing">
						<h3>6.3 Response</h3>
						
						<section id="Headers_Response_BatchProcessing">
							<h4>6.3.1 Headers</h4>
							<p>The batch response, as shown in the example below, must contain a Content-Type header specifying a content type of multipart/mixed and a batch boundary specification which may be different than the batch boundary that was used in the corresponding request.</p>
<pre><strong>HTTP/1.1 202 Accepted</strong>
<strong>DataServiceVersion: </strong>1.0
<strong>Content-Length: </strong>1254
<strong>Content-Type: </strong>multipart/mixed; boundary=batch(36522ad7-fc75-4b56-8c71-56071383e77b)
						</section>
						<section id="Body_Response_BatchProcessing">
							<h4>6.3.2 Message Body</h4>
							<p>Within the body of the batch response is a response for each retrieve request and ChangeSet that was in the associated Batch request. The order of responses in the response body must match the order of requests in the Batch request. Each response includes a Content-Type header with a value of "application/http", and a Content-Transfer-Encoding MIME header with a value of "binary".</p>
							<p>A response to a retrieve request is formatted exactly as it would have appeared outside of a batch as described in [OData-Operations] .</p>
							<p>The body of a ChangeSet response is either a response for all the successfully processed change request within the ChangeSet, formatted exactly as it would have appeared outside of a batch, as described in [OData-Operations] , or a single response indicating a failure of the entire ChangeSet, as described in [OData-Operations].</p>
							<p>For example, referencing the batch request in section 2.2, assume all the requests except the final retrieve request succeed. In this case the Batch response body would be as shown in the following example.</p>
<pre><strong>HTTP/1.1 202 Accepted</strong>
<strong>DataServiceVersion: </strong>1.0
<strong>Content-Length: </strong>####
<strong>Content-Type: </strong>multipart/mixed; boundary=batch(36522ad7-fc75-4b56-8c71-56071383e77b)
<code>
--batch(36522ad7-fc75-4b56-8c71-56071383e77b)
Content-Type: application/http
Content-Transfer-Encoding: binary

HTTP/1.1 200 Ok
Content-Type: application/atom+xml;type=entry
Content-Length: ###

<AtomPub representation of the Customer entity with EntityKey ALFKI>

--batch(36522ad7-fc75-4b56-8c71-56071383e77b)
Content-Type: multipart/mixed; boundary=changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621)
Content-Length: ###      

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621)
Content-Type: application/http
Content-Transfer-Encoding: binary

HTTP/1.1 201 Created
Content-Type: application/atom+xml;type=entry
Location: http://host/service.svc/Customer('POIUY')
Content-Length: ###

<AtomPub representation of a new Customer entity>

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621)
Content-Type: application/http
Content-Transfer-Encoding: binary

HTTP/1.1 204 No Content
Host: host

--changeset(77162fcd-b8da-41ac-a9f8-9357efbbd621)--

--batch(36522ad7-fc75-4b56-8c71-56071383e77b)
Content-Type: application/http
Content-Transfer-Encoding: binary

HTTP/1.1 404 Not Found
Content-Type: application/xml
Content-Length: ###

<Error message>
--batch(36522ad7-fc75-4b56-8c71-56071383e77b)--</code></pre>
						</section>
					</section>
				</section>
				<section id="StatusCode">
					<h2>7. HTTP Status Code</h2>
					<p>All status codes used in the SensorThings API follow the <a target="_blank" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">standard HTTP status codes</a>. A high-level explanation of the status codes is as follows:</p>
					<br/>
<table class="table table-striped">
<thead>
						<tr>
							<th>HTTP Status Code</th>
							<th>Description</th>
						</tr>
						</thead>
						<tr>
							<td>2xx</td>
							<td>Success</td>
						</tr>
						<tr>
							<td>3xx</td>
							<td>Redirection</td>
						</tr>
						<tr>
							<td>4xx</td>
							<td>Client-side Error</td>
						</tr>
						<tr>
							<td>5xx</td>
							<td>Server-side Error</td>
						</tr>
					</table>
					<br/>
				</section>
			</div>
			
			<div id="footer" class="clearfix">
				<div class="container">
					<hr>
					<div id="footer-wrapper">
						<div class="row-fluid">
							<div class="span12">
								<div class="span6"></div><!-- end of col-460 -->
								<div class="span6">
									<div class="social-icons"></div><!-- end of .social-icons -->
								</div><!-- end of col-460 fit -->
							</div>
							<div class="row-fluid">
								<div class="span5 copyright"> &copy; 2013 | OGC SensorThings API </div> <!-- end copyright -->
								<div class="span5 powered"></div><!-- end .powered -->
							</div>
						</div><!-- end of row -->
					</div><!-- end #footer-wrapper -->
				</div>
			</div><!-- end #footer -->
		</div>
		
		<script src="js/jquery.js"></script>
		<script src="js/jquery.smooth-scroll.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/bootswatch.js"></script>
	</body>
</html>
